---
title: Methods
index: true
description: Comprehensive mutation operations for creating, updating, and deleting data with support for soft deletes and data validation
---

import { TypeTable } from 'fumadocs-ui/components/type-table'


The Drizzle Service provides robust mutation operations that allow you to create, update, and delete data in your database safely and efficiently. These operations include comprehensive error handling, hooks for custom logic, and built-in support for soft deletes.

## Key Features
| Feature | Description |
|---------|-------------|
| **Type-Safe Mutations** | Full TypeScript support with compile-time validation |
| **Error Handling** | Built-in error handling with detailed error information using ErrorFirst pattern |
| **Soft Delete Support** | Configurable soft delete functionality with automatic handling |
| **Lifecycle Hooks** | Before and after hooks for custom business logic |
| **Data Validation** | Automatic validation of required fields and constraints |
| **Transaction Support** | Automatic transaction handling for data consistency |
| **Optimistic Updates** | Support for optimistic UI updates with rollback capabilities |

## Available Operations

### Basic Mutation Operations

- `create(data, hooks?)` - Create a new record with optional lifecycle hooks
- `update(id, data, hooks?)` - Update an existing record by ID
- `delete(id, hooks?)` - Soft delete a record (if configured) or hard delete
- `hardDelete(id, hooks?)` - Permanently delete a record from the database
- `restore(id, hooks?)` - Restore a soft-deleted record


## Return Types

All mutation operations return a `Handler<T>` type, which is a tuple containing either:
- `[null, result]` - Success case with the operation result
- `[error, null]` - Error case with detailed error information

This pattern enables comprehensive error handling without throwing exceptions.

## Service Hooks

Mutation operations support lifecycle hooks that allow you to inject custom logic:

<TypeTable
  type={{
    beforeAction: {
      description: 'Called before the mutation action is performed',
      type: '(data: T[\'$inferSelect\']) => Promise<void>',
    },
    afterAction: {
      description: 'Called after the mutation action is successfully completed',
      type: '(data: T[\'$inferSelect\']) => Promise<void>',
    },
    onError: {
      description: 'Called when an error occurs during the mutation action',
      type: '(error: Error) => Promise<void>',
    }
  }}
/>

## Soft Delete Configuration

Soft deletes can be configured when creating the service instance:

<TypeTable
  type={{
    field: {
      description: 'The field name used to track soft delete status',
      type: 'keyof T[\'$inferSelect\']',
      required: true
    },
    deletedValue: {
      description: 'Value indicating a record is soft deleted',
      type: 'T[\'$inferSelect\'][field] | \'NOT_NULL\'',
      required: true
    },
    notDeletedValue: {
      description: 'Value indicating a record is not deleted (optional for boolean fields)',
      type: 'T[\'$inferSelect\'][field] | null',
    }
  }}
/>

## Error Handling

The service provides comprehensive error handling with detailed error information:

- **Validation Errors**: Missing required fields, invalid data types
- **Constraint Violations**: Unique key violations, foreign key constraints
- **Database Errors**: Connection issues, permission problems
- **Business Logic Errors**: Custom validation failures from hooks

